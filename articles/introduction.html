<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to SuperML • SuperML</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to SuperML">
<meta property="og:description" content="superml">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SuperML</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.5.7</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/superml_tutorial.html">Introduction to superml</a>
    </li>
    <li>
      <a href="../articles/Guide-to-CountVectorizer.html">Guide to CountVectorizer</a>
    </li>
    <li>
      <a href="../articles/Guide-to-TfidfVectorizer.html">Guide to TfIdfVectorizer</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/saraswatmks/superml" class="external-link">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://www.linkedin.com/in/saraswatmanish/" class="external-link">
    <span class="fa fa-linkedin fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introduction to SuperML</h1>
                        <h4 data-toc-skip class="author">Manish
Saraswat</h4>
            
            <h4 data-toc-skip class="date">2024-06-03</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/saraswatmks/superml/blob/HEAD/vignettes/introduction.Rmd" class="external-link"><code>vignettes/introduction.Rmd</code></a></small>
      <div class="hidden name"><code>introduction.Rmd</code></div>

    </div>

    
    
<p>SuperML R package is designed to unify the model training process in
R like Python. Generally, it’s seen that people spend lot of time in
searching for packages, figuring out the syntax for training machine
learning models in R. This behaviour is highly apparent in users who
frequently switch between R and Python. This package provides a python´s
scikit-learn interface (<code>fit</code>, <code>predict</code>) to train
models faster.</p>
<p>In addition to building machine learning models, there are handy
functionalities to do feature engineering</p>
<p>This ambitious package is my ongoing effort to help the r-community
build ML models easily and faster in R.</p>
<div class="section level2">
<h2 id="install">Install<a class="anchor" aria-label="anchor" href="#install"></a>
</h2>
<p>You can install latest cran version using (recommended):</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"superml"</span><span class="op">)</span></span></code></pre></div>
<p>You can install the developmemt version directly from github
using:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"saraswatmks/superml"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="caveats-on-superml-installation">Caveats on superml installation<a class="anchor" aria-label="anchor" href="#caveats-on-superml-installation"></a>
</h2>
<p>For machine learning, superml is based on the existing R packages.
Hence, while installing the package, we don’t install all the
dependencies. However, while training any model, superml will
automatically install the package if its not found. Still, if you want
to install all dependencies at once, you can simply do:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"superml"</span>, dependencies<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="examples---machine-learning-models">Examples - Machine Learning Models<a class="anchor" aria-label="anchor" href="#examples---machine-learning-models"></a>
</h2>
<p>This package uses existing r-packages to build machine learning
model. In this tutorial, we’ll use data.table R package to do all tasks
related to data manipulation.</p>
<div class="section level3">
<h3 id="regression-data">Regression Data<a class="anchor" aria-label="anchor" href="#regression-data"></a>
</h3>
<p>We’ll quickly prepare the data set to be ready to served for model
training.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="st">"../data/reg_train.rda"</span><span class="op">)</span></span>
<span><span class="co"># if the above doesn't work, you can try: load("reg_train.rda")</span></span>
<span><span class="co"># superml::check_package("caret")</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/topepo/caret/" class="external-link">caret</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: ggplot2</span></span>
<span><span class="co">#&gt; Loading required package: lattice</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/saraswatmks/superml" class="external-link">superml</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: R6</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/mfrasco/Metrics" class="external-link">Metrics</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'Metrics'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:caret':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     precision, recall</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">reg_train</span><span class="op">)</span></span>
<span><span class="co">#&gt;       Id MSSubClass MSZoning LotFrontage LotArea Street  Alley LotShape</span></span>
<span><span class="co">#&gt;    &lt;int&gt;      &lt;int&gt;   &lt;char&gt;       &lt;int&gt;   &lt;int&gt; &lt;char&gt; &lt;char&gt;   &lt;char&gt;</span></span>
<span><span class="co">#&gt; 1:     1         60       RL          65    8450   Pave   &lt;NA&gt;      Reg</span></span>
<span><span class="co">#&gt; 2:     2         20       RL          80    9600   Pave   &lt;NA&gt;      Reg</span></span>
<span><span class="co">#&gt; 3:     3         60       RL          68   11250   Pave   &lt;NA&gt;      IR1</span></span>
<span><span class="co">#&gt; 4:     4         70       RL          60    9550   Pave   &lt;NA&gt;      IR1</span></span>
<span><span class="co">#&gt; 5:     5         60       RL          84   14260   Pave   &lt;NA&gt;      IR1</span></span>
<span><span class="co">#&gt; 6:     6         50       RL          85   14115   Pave   &lt;NA&gt;      IR1</span></span>
<span><span class="co">#&gt;    LandContour Utilities LotConfig LandSlope Neighborhood Condition1 Condition2</span></span>
<span><span class="co">#&gt;         &lt;char&gt;    &lt;char&gt;    &lt;char&gt;    &lt;char&gt;       &lt;char&gt;     &lt;char&gt;     &lt;char&gt;</span></span>
<span><span class="co">#&gt; 1:         Lvl    AllPub    Inside       Gtl      CollgCr       Norm       Norm</span></span>
<span><span class="co">#&gt; 2:         Lvl    AllPub       FR2       Gtl      Veenker      Feedr       Norm</span></span>
<span><span class="co">#&gt; 3:         Lvl    AllPub    Inside       Gtl      CollgCr       Norm       Norm</span></span>
<span><span class="co">#&gt; 4:         Lvl    AllPub    Corner       Gtl      Crawfor       Norm       Norm</span></span>
<span><span class="co">#&gt; 5:         Lvl    AllPub       FR2       Gtl      NoRidge       Norm       Norm</span></span>
<span><span class="co">#&gt; 6:         Lvl    AllPub    Inside       Gtl      Mitchel       Norm       Norm</span></span>
<span><span class="co">#&gt;    BldgType HouseStyle OverallQual OverallCond YearBuilt YearRemodAdd RoofStyle</span></span>
<span><span class="co">#&gt;      &lt;char&gt;     &lt;char&gt;       &lt;int&gt;       &lt;int&gt;     &lt;int&gt;        &lt;int&gt;    &lt;char&gt;</span></span>
<span><span class="co">#&gt; 1:     1Fam     2Story           7           5      2003         2003     Gable</span></span>
<span><span class="co">#&gt; 2:     1Fam     1Story           6           8      1976         1976     Gable</span></span>
<span><span class="co">#&gt; 3:     1Fam     2Story           7           5      2001         2002     Gable</span></span>
<span><span class="co">#&gt; 4:     1Fam     2Story           7           5      1915         1970     Gable</span></span>
<span><span class="co">#&gt; 5:     1Fam     2Story           8           5      2000         2000     Gable</span></span>
<span><span class="co">#&gt; 6:     1Fam     1.5Fin           5           5      1993         1995     Gable</span></span>
<span><span class="co">#&gt;    RoofMatl Exterior1st Exterior2nd MasVnrType MasVnrArea ExterQual ExterCond</span></span>
<span><span class="co">#&gt;      &lt;char&gt;      &lt;char&gt;      &lt;char&gt;     &lt;char&gt;      &lt;int&gt;    &lt;char&gt;    &lt;char&gt;</span></span>
<span><span class="co">#&gt; 1:  CompShg     VinylSd     VinylSd    BrkFace        196        Gd        TA</span></span>
<span><span class="co">#&gt; 2:  CompShg     MetalSd     MetalSd       None          0        TA        TA</span></span>
<span><span class="co">#&gt; 3:  CompShg     VinylSd     VinylSd    BrkFace        162        Gd        TA</span></span>
<span><span class="co">#&gt; 4:  CompShg     Wd Sdng     Wd Shng       None          0        TA        TA</span></span>
<span><span class="co">#&gt; 5:  CompShg     VinylSd     VinylSd    BrkFace        350        Gd        TA</span></span>
<span><span class="co">#&gt; 6:  CompShg     VinylSd     VinylSd       None          0        TA        TA</span></span>
<span><span class="co">#&gt;    Foundation BsmtQual BsmtCond BsmtExposure BsmtFinType1 BsmtFinSF1</span></span>
<span><span class="co">#&gt;        &lt;char&gt;   &lt;char&gt;   &lt;char&gt;       &lt;char&gt;       &lt;char&gt;      &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1:      PConc       Gd       TA           No          GLQ        706</span></span>
<span><span class="co">#&gt; 2:     CBlock       Gd       TA           Gd          ALQ        978</span></span>
<span><span class="co">#&gt; 3:      PConc       Gd       TA           Mn          GLQ        486</span></span>
<span><span class="co">#&gt; 4:     BrkTil       TA       Gd           No          ALQ        216</span></span>
<span><span class="co">#&gt; 5:      PConc       Gd       TA           Av          GLQ        655</span></span>
<span><span class="co">#&gt; 6:       Wood       Gd       TA           No          GLQ        732</span></span>
<span><span class="co">#&gt;    BsmtFinType2 BsmtFinSF2 BsmtUnfSF TotalBsmtSF Heating HeatingQC CentralAir</span></span>
<span><span class="co">#&gt;          &lt;char&gt;      &lt;int&gt;     &lt;int&gt;       &lt;int&gt;  &lt;char&gt;    &lt;char&gt;     &lt;char&gt;</span></span>
<span><span class="co">#&gt; 1:          Unf          0       150         856    GasA        Ex          Y</span></span>
<span><span class="co">#&gt; 2:          Unf          0       284        1262    GasA        Ex          Y</span></span>
<span><span class="co">#&gt; 3:          Unf          0       434         920    GasA        Ex          Y</span></span>
<span><span class="co">#&gt; 4:          Unf          0       540         756    GasA        Gd          Y</span></span>
<span><span class="co">#&gt; 5:          Unf          0       490        1145    GasA        Ex          Y</span></span>
<span><span class="co">#&gt; 6:          Unf          0        64         796    GasA        Ex          Y</span></span>
<span><span class="co">#&gt;    Electrical 1stFlrSF 2ndFlrSF LowQualFinSF GrLivArea BsmtFullBath</span></span>
<span><span class="co">#&gt;        &lt;char&gt;    &lt;int&gt;    &lt;int&gt;        &lt;int&gt;     &lt;int&gt;        &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1:      SBrkr      856      854            0      1710            1</span></span>
<span><span class="co">#&gt; 2:      SBrkr     1262        0            0      1262            0</span></span>
<span><span class="co">#&gt; 3:      SBrkr      920      866            0      1786            1</span></span>
<span><span class="co">#&gt; 4:      SBrkr      961      756            0      1717            1</span></span>
<span><span class="co">#&gt; 5:      SBrkr     1145     1053            0      2198            1</span></span>
<span><span class="co">#&gt; 6:      SBrkr      796      566            0      1362            1</span></span>
<span><span class="co">#&gt;    BsmtHalfBath FullBath HalfBath BedroomAbvGr KitchenAbvGr KitchenQual</span></span>
<span><span class="co">#&gt;           &lt;int&gt;    &lt;int&gt;    &lt;int&gt;        &lt;int&gt;        &lt;int&gt;      &lt;char&gt;</span></span>
<span><span class="co">#&gt; 1:            0        2        1            3            1          Gd</span></span>
<span><span class="co">#&gt; 2:            1        2        0            3            1          TA</span></span>
<span><span class="co">#&gt; 3:            0        2        1            3            1          Gd</span></span>
<span><span class="co">#&gt; 4:            0        1        0            3            1          Gd</span></span>
<span><span class="co">#&gt; 5:            0        2        1            4            1          Gd</span></span>
<span><span class="co">#&gt; 6:            0        1        1            1            1          TA</span></span>
<span><span class="co">#&gt;    TotRmsAbvGrd Functional Fireplaces FireplaceQu GarageType GarageYrBlt</span></span>
<span><span class="co">#&gt;           &lt;int&gt;     &lt;char&gt;      &lt;int&gt;      &lt;char&gt;     &lt;char&gt;       &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1:            8        Typ          0        &lt;NA&gt;     Attchd        2003</span></span>
<span><span class="co">#&gt; 2:            6        Typ          1          TA     Attchd        1976</span></span>
<span><span class="co">#&gt; 3:            6        Typ          1          TA     Attchd        2001</span></span>
<span><span class="co">#&gt; 4:            7        Typ          1          Gd     Detchd        1998</span></span>
<span><span class="co">#&gt; 5:            9        Typ          1          TA     Attchd        2000</span></span>
<span><span class="co">#&gt; 6:            5        Typ          0        &lt;NA&gt;     Attchd        1993</span></span>
<span><span class="co">#&gt;    GarageFinish GarageCars GarageArea GarageQual GarageCond PavedDrive</span></span>
<span><span class="co">#&gt;          &lt;char&gt;      &lt;int&gt;      &lt;int&gt;     &lt;char&gt;     &lt;char&gt;     &lt;char&gt;</span></span>
<span><span class="co">#&gt; 1:          RFn          2        548         TA         TA          Y</span></span>
<span><span class="co">#&gt; 2:          RFn          2        460         TA         TA          Y</span></span>
<span><span class="co">#&gt; 3:          RFn          2        608         TA         TA          Y</span></span>
<span><span class="co">#&gt; 4:          Unf          3        642         TA         TA          Y</span></span>
<span><span class="co">#&gt; 5:          RFn          3        836         TA         TA          Y</span></span>
<span><span class="co">#&gt; 6:          Unf          2        480         TA         TA          Y</span></span>
<span><span class="co">#&gt;    WoodDeckSF OpenPorchSF EnclosedPorch 3SsnPorch ScreenPorch PoolArea PoolQC</span></span>
<span><span class="co">#&gt;         &lt;int&gt;       &lt;int&gt;         &lt;int&gt;     &lt;int&gt;       &lt;int&gt;    &lt;int&gt; &lt;char&gt;</span></span>
<span><span class="co">#&gt; 1:          0          61             0         0           0        0   &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 2:        298           0             0         0           0        0   &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 3:          0          42             0         0           0        0   &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 4:          0          35           272         0           0        0   &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 5:        192          84             0         0           0        0   &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 6:         40          30             0       320           0        0   &lt;NA&gt;</span></span>
<span><span class="co">#&gt;     Fence MiscFeature MiscVal MoSold YrSold SaleType SaleCondition SalePrice</span></span>
<span><span class="co">#&gt;    &lt;char&gt;      &lt;char&gt;   &lt;int&gt;  &lt;int&gt;  &lt;int&gt;   &lt;char&gt;        &lt;char&gt;     &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1:   &lt;NA&gt;        &lt;NA&gt;       0      2   2008       WD        Normal    208500</span></span>
<span><span class="co">#&gt; 2:   &lt;NA&gt;        &lt;NA&gt;       0      5   2007       WD        Normal    181500</span></span>
<span><span class="co">#&gt; 3:   &lt;NA&gt;        &lt;NA&gt;       0      9   2008       WD        Normal    223500</span></span>
<span><span class="co">#&gt; 4:   &lt;NA&gt;        &lt;NA&gt;       0      2   2006       WD       Abnorml    140000</span></span>
<span><span class="co">#&gt; 5:   &lt;NA&gt;        &lt;NA&gt;       0     12   2008       WD        Normal    250000</span></span>
<span><span class="co">#&gt; 6:  MnPrv        Shed     700     10   2009       WD        Normal    143000</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">split</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/caret/man/createDataPartition.html" class="external-link">createDataPartition</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">reg_train</span><span class="op">$</span><span class="va">SalePrice</span>, p <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span></span>
<span><span class="va">xtrain</span> <span class="op">&lt;-</span> <span class="va">reg_train</span><span class="op">[</span><span class="va">split</span><span class="op">$</span><span class="va">Resample1</span><span class="op">]</span></span>
<span><span class="va">xtest</span> <span class="op">&lt;-</span> <span class="va">reg_train</span><span class="op">[</span><span class="op">!</span><span class="va">split</span><span class="op">$</span><span class="va">Resample1</span><span class="op">]</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># remove features with 90% or more missing values</span></span>
<span><span class="co"># we will also remove the Id column because it doesn't contain</span></span>
<span><span class="co"># any useful information</span></span>
<span><span class="va">na_cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">xtrain</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">xtrain</span><span class="op">)</span></span>
<span><span class="va">na_cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">na_cols</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">na_cols</span> <span class="op">&gt;</span> <span class="fl">0.9</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">xtrain</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">na_cols</span>, <span class="st">"Id"</span><span class="op">)</span> <span class="op">:=</span> <span class="cn">NULL</span><span class="op">]</span></span>
<span><span class="va">xtest</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">na_cols</span>, <span class="st">"Id"</span><span class="op">)</span> <span class="op">:=</span> <span class="cn">NULL</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># encode categorical variables</span></span>
<span><span class="va">cat_cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">xtrain</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">xtrain</span>, <span class="va">is.character</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">c</span> <span class="kw">in</span> <span class="va">cat_cols</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">lbl</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/LabelEncoder.html">LabelEncoder</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="va">lbl</span><span class="op">$</span><span class="fu">fit</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">xtrain</span><span class="op">[[</span><span class="va">c</span><span class="op">]</span><span class="op">]</span>, <span class="va">xtest</span><span class="op">[[</span><span class="va">c</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">xtrain</span><span class="op">[[</span><span class="va">c</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">lbl</span><span class="op">$</span><span class="fu">transform</span><span class="op">(</span><span class="va">xtrain</span><span class="op">[[</span><span class="va">c</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">xtest</span><span class="op">[[</span><span class="va">c</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">lbl</span><span class="op">$</span><span class="fu">transform</span><span class="op">(</span><span class="va">xtest</span><span class="op">[[</span><span class="va">c</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; The data contains NA values. Imputing NA with 'NA' </span></span>
<span><span class="co">#&gt; The data contains NA values. Imputing NA with 'NA' </span></span>
<span><span class="co">#&gt; The data contains NA values. Imputing NA with 'NA' </span></span>
<span><span class="co">#&gt; The data contains NA values. Imputing NA with 'NA' </span></span>
<span><span class="co">#&gt; The data contains NA values. Imputing NA with 'NA' </span></span>
<span><span class="co">#&gt; The data contains NA values. Imputing NA with 'NA' </span></span>
<span><span class="co">#&gt; The data contains NA values. Imputing NA with 'NA' </span></span>
<span><span class="co">#&gt; The data contains NA values. Imputing NA with 'NA' </span></span>
<span><span class="co">#&gt; The data contains NA values. Imputing NA with 'NA' </span></span>
<span><span class="co">#&gt; The data contains NA values. Imputing NA with 'NA' </span></span>
<span><span class="co">#&gt; The data contains NA values. Imputing NA with 'NA' </span></span>
<span><span class="co">#&gt; The data contains NA values. Imputing NA with 'NA' </span></span>
<span><span class="co">#&gt; The data contains NA values. Imputing NA with 'NA' </span></span>
<span><span class="co">#&gt; The data contains NA values. Imputing NA with 'NA' </span></span>
<span><span class="co">#&gt; The data contains NA values. Imputing NA with 'NA' </span></span>
<span><span class="co">#&gt; The data contains NA values. Imputing NA with 'NA' </span></span>
<span><span class="co">#&gt; The data contains NA values. Imputing NA with 'NA' </span></span>
<span><span class="co">#&gt; The data contains NA values. Imputing NA with 'NA' </span></span>
<span><span class="co">#&gt; The data contains NA values. Imputing NA with 'NA' </span></span>
<span><span class="co">#&gt; The data contains NA values. Imputing NA with 'NA' </span></span>
<span><span class="co">#&gt; The data contains NA values. Imputing NA with 'NA' </span></span>
<span><span class="co">#&gt; The data contains NA values. Imputing NA with 'NA' </span></span>
<span><span class="co">#&gt; The data contains NA values. Imputing NA with 'NA' </span></span>
<span><span class="co">#&gt; The data contains NA values. Imputing NA with 'NA' </span></span>
<span><span class="co">#&gt; The data contains NA values. Imputing NA with 'NA' </span></span>
<span><span class="co">#&gt; The data contains NA values. Imputing NA with 'NA' </span></span>
<span><span class="co">#&gt; The data contains NA values. Imputing NA with 'NA' </span></span>
<span><span class="co">#&gt; The data contains NA values. Imputing NA with 'NA' </span></span>
<span><span class="co">#&gt; The data contains NA values. Imputing NA with 'NA' </span></span>
<span><span class="co">#&gt; The data contains NA values. Imputing NA with 'NA' </span></span>
<span><span class="co">#&gt; The data contains NA values. Imputing NA with 'NA' </span></span>
<span><span class="co">#&gt; The data contains NA values. Imputing NA with 'NA' </span></span>
<span><span class="co">#&gt; The data contains NA values. Imputing NA with 'NA' </span></span>
<span><span class="co">#&gt; The data contains NA values. Imputing NA with 'NA' </span></span>
<span><span class="co">#&gt; The data contains NA values. Imputing NA with 'NA' </span></span>
<span><span class="co">#&gt; The data contains NA values. Imputing NA with 'NA' </span></span>
<span><span class="co">#&gt; The data contains NA values. Imputing NA with 'NA' </span></span>
<span><span class="co">#&gt; The data contains NA values. Imputing NA with 'NA'</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># removing noise column</span></span>
<span><span class="va">noise</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'GrLivArea'</span>,<span class="st">'TotalBsmtSF'</span><span class="op">)</span></span>
<span></span>
<span><span class="va">xtrain</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">noise</span><span class="op">)</span> <span class="op">:=</span> <span class="cn">NULL</span><span class="op">]</span></span>
<span><span class="va">xtest</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">noise</span><span class="op">)</span> <span class="op">:=</span> <span class="cn">NULL</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># fill missing value with  -1</span></span>
<span><span class="va">xtrain</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">xtrain</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">1</span></span>
<span><span class="va">xtest</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">xtest</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">1</span></span></code></pre></div>
<p><strong>KNN Regression</strong></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">knn</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/KNNTrainer.html">KNNTrainer</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>k <span class="op">=</span> <span class="fl">2</span>,prob <span class="op">=</span> <span class="cn">T</span>,type <span class="op">=</span> <span class="st">'reg'</span><span class="op">)</span></span>
<span><span class="va">knn</span><span class="op">$</span><span class="fu">fit</span><span class="op">(</span>train <span class="op">=</span> <span class="va">xtrain</span>, test <span class="op">=</span> <span class="va">xtest</span>, y <span class="op">=</span> <span class="st">'SalePrice'</span><span class="op">)</span></span>
<span><span class="va">probs</span> <span class="op">&lt;-</span> <span class="va">knn</span><span class="op">$</span><span class="fu">predict</span><span class="op">(</span>type <span class="op">=</span> <span class="st">'prob'</span><span class="op">)</span></span>
<span><span class="va">labels</span> <span class="op">&lt;-</span> <span class="va">knn</span><span class="op">$</span><span class="fu">predict</span><span class="op">(</span>type<span class="op">=</span><span class="st">'raw'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html" class="external-link">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">xtest</span><span class="op">$</span><span class="va">SalePrice</span>, predicted<span class="op">=</span><span class="va">labels</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 53888.76</span></span></code></pre></div>
<p><strong>SVM Regression</strong></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">svm</span> <span class="op">&lt;-</span> <span class="va">SVMTrainer</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">svm</span><span class="op">$</span><span class="fu">fit</span><span class="op">(</span><span class="va">xtrain</span>, <span class="st">'SalePrice'</span><span class="op">)</span></span>
<span><span class="va">pred</span> <span class="op">&lt;-</span> <span class="va">svm</span><span class="op">$</span><span class="fu">predict</span><span class="op">(</span><span class="va">xtest</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html" class="external-link">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">xtest</span><span class="op">$</span><span class="va">SalePrice</span>, predicted <span class="op">=</span> <span class="va">pred</span><span class="op">)</span></span></code></pre></div>
<p><strong>Simple Regresison</strong></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lf</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/LMTrainer.html">LMTrainer</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>family<span class="op">=</span><span class="st">"gaussian"</span><span class="op">)</span></span>
<span><span class="va">lf</span><span class="op">$</span><span class="fu">fit</span><span class="op">(</span>X <span class="op">=</span> <span class="va">xtrain</span>, y <span class="op">=</span> <span class="st">"SalePrice"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">lf</span><span class="op">$</span><span class="va">model</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; stats::glm(formula = f, family = self$family, data = X, weights = self$weights)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients: (1 not defined because of singularities)</span></span>
<span><span class="co">#&gt;                 Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)   -2.676e+05  1.522e+06  -0.176 0.860469    </span></span>
<span><span class="co">#&gt; MSSubClass    -1.530e+02  5.814e+01  -2.632 0.008637 ** </span></span>
<span><span class="co">#&gt; MSZoning       8.021e+02  1.389e+03   0.577 0.563868    </span></span>
<span><span class="co">#&gt; LotFrontage    4.390e+00  3.149e+01   0.139 0.889142    </span></span>
<span><span class="co">#&gt; LotArea        5.018e-01  1.296e-01   3.872 0.000115 ***</span></span>
<span><span class="co">#&gt; Street        -9.289e+03  1.596e+04  -0.582 0.560596    </span></span>
<span><span class="co">#&gt; LotShape       1.341e+03  1.919e+03   0.699 0.484915    </span></span>
<span><span class="co">#&gt; LandContour    1.171e+03  1.830e+03   0.640 0.522388    </span></span>
<span><span class="co">#&gt; Utilities             NA         NA      NA       NA    </span></span>
<span><span class="co">#&gt; LotConfig      1.861e+03  1.038e+03   1.794 0.073169 .  </span></span>
<span><span class="co">#&gt; LandSlope      5.826e+03  4.383e+03   1.329 0.184052    </span></span>
<span><span class="co">#&gt; Neighborhood  -4.958e+02  1.738e+02  -2.852 0.004438 ** </span></span>
<span><span class="co">#&gt; Condition1    -2.150e+03  6.656e+02  -3.230 0.001281 ** </span></span>
<span><span class="co">#&gt; Condition2    -3.062e+03  3.276e+03  -0.935 0.350132    </span></span>
<span><span class="co">#&gt; BldgType      -1.378e+02  2.409e+03  -0.057 0.954381    </span></span>
<span><span class="co">#&gt; HouseStyle     6.303e+02  7.967e+02   0.791 0.429089    </span></span>
<span><span class="co">#&gt; OverallQual    1.425e+04  1.289e+03  11.061  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; OverallCond    5.863e+03  1.161e+03   5.048 5.35e-07 ***</span></span>
<span><span class="co">#&gt; YearBuilt      4.382e+02  7.857e+01   5.578 3.18e-08 ***</span></span>
<span><span class="co">#&gt; YearRemodAdd   3.682e+01  7.658e+01   0.481 0.630800    </span></span>
<span><span class="co">#&gt; RoofStyle      5.680e+03  1.918e+03   2.961 0.003140 ** </span></span>
<span><span class="co">#&gt; RoofMatl      -2.135e+04  2.578e+03  -8.283 4.05e-16 ***</span></span>
<span><span class="co">#&gt; Exterior1st   -5.685e+02  6.751e+02  -0.842 0.399941    </span></span>
<span><span class="co">#&gt; Exterior2nd    6.353e+02  5.837e+02   1.088 0.276664    </span></span>
<span><span class="co">#&gt; MasVnrType     3.989e+03  1.653e+03   2.413 0.016032 *  </span></span>
<span><span class="co">#&gt; MasVnrArea     2.246e+01  6.464e+00   3.474 0.000535 ***</span></span>
<span><span class="co">#&gt; ExterQual      2.887e+03  2.240e+03   1.289 0.197738    </span></span>
<span><span class="co">#&gt; ExterCond      3.339e+01  2.356e+03   0.014 0.988696    </span></span>
<span><span class="co">#&gt; Foundation    -2.351e+03  1.985e+03  -1.184 0.236622    </span></span>
<span><span class="co">#&gt; BsmtQual       5.072e+03  1.210e+03   4.192 3.03e-05 ***</span></span>
<span><span class="co">#&gt; BsmtCond      -2.506e+03  1.802e+03  -1.391 0.164508    </span></span>
<span><span class="co">#&gt; BsmtExposure   1.243e+03  9.652e+02   1.288 0.198184    </span></span>
<span><span class="co">#&gt; BsmtFinType1  -1.404e+03  7.272e+02  -1.930 0.053912 .  </span></span>
<span><span class="co">#&gt; BsmtFinSF1     7.491e+00  5.564e+00   1.346 0.178528    </span></span>
<span><span class="co">#&gt; BsmtFinType2  -1.021e+03  1.117e+03  -0.914 0.360910    </span></span>
<span><span class="co">#&gt; BsmtFinSF2     1.377e+01  9.233e+00   1.492 0.136119    </span></span>
<span><span class="co">#&gt; BsmtUnfSF      6.000e-01  5.185e+00   0.116 0.907913    </span></span>
<span><span class="co">#&gt; Heating       -2.997e+03  3.259e+03  -0.920 0.357958    </span></span>
<span><span class="co">#&gt; HeatingQC     -1.199e+03  1.378e+03  -0.870 0.384316    </span></span>
<span><span class="co">#&gt; CentralAir     5.611e+03  5.185e+03   1.082 0.279458    </span></span>
<span><span class="co">#&gt; Electrical     4.201e+03  2.653e+03   1.583 0.113653    </span></span>
<span><span class="co">#&gt; `1stFlrSF`     6.423e+01  6.894e+00   9.317  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; `2ndFlrSF`     6.155e+01  5.691e+00  10.814  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; LowQualFinSF   1.269e+01  2.535e+01   0.500 0.616902    </span></span>
<span><span class="co">#&gt; BsmtFullBath   8.002e+03  2.818e+03   2.840 0.004611 ** </span></span>
<span><span class="co">#&gt; BsmtHalfBath   5.335e+03  4.161e+03   1.282 0.200104    </span></span>
<span><span class="co">#&gt; FullBath       8.534e+03  3.048e+03   2.800 0.005219 ** </span></span>
<span><span class="co">#&gt; HalfBath      -1.264e+03  2.816e+03  -0.449 0.653591    </span></span>
<span><span class="co">#&gt; BedroomAbvGr  -9.956e+03  1.862e+03  -5.346 1.13e-07 ***</span></span>
<span><span class="co">#&gt; KitchenAbvGr  -1.919e+04  5.829e+03  -3.292 0.001030 ** </span></span>
<span><span class="co">#&gt; KitchenQual    9.338e+03  1.492e+03   6.258 5.91e-10 ***</span></span>
<span><span class="co">#&gt; TotRmsAbvGrd   2.002e+03  1.336e+03   1.498 0.134339    </span></span>
<span><span class="co">#&gt; Functional    -4.075e+03  1.320e+03  -3.087 0.002077 ** </span></span>
<span><span class="co">#&gt; Fireplaces    -3.626e+03  2.604e+03  -1.392 0.164104    </span></span>
<span><span class="co">#&gt; FireplaceQu    3.860e+03  1.393e+03   2.772 0.005676 ** </span></span>
<span><span class="co">#&gt; GarageType    -9.296e+01  1.051e+03  -0.088 0.929526    </span></span>
<span><span class="co">#&gt; GarageYrBlt   -5.976e+00  5.316e+00  -1.124 0.261217    </span></span>
<span><span class="co">#&gt; GarageFinish   2.023e+03  1.409e+03   1.436 0.151392    </span></span>
<span><span class="co">#&gt; GarageCars     1.755e+04  3.256e+03   5.388 8.97e-08 ***</span></span>
<span><span class="co">#&gt; GarageArea    -1.429e+01  1.051e+01  -1.360 0.174047    </span></span>
<span><span class="co">#&gt; GarageQual     1.224e+03  3.181e+03   0.385 0.700458    </span></span>
<span><span class="co">#&gt; GarageCond     1.466e+03  3.556e+03   0.412 0.680175    </span></span>
<span><span class="co">#&gt; PavedDrive     4.735e+02  3.009e+03   0.157 0.875013    </span></span>
<span><span class="co">#&gt; WoodDeckSF     2.329e+01  8.445e+00   2.757 0.005937 ** </span></span>
<span><span class="co">#&gt; OpenPorchSF   -4.354e+00  1.613e+01  -0.270 0.787257    </span></span>
<span><span class="co">#&gt; EnclosedPorch  7.698e+00  1.828e+01   0.421 0.673800    </span></span>
<span><span class="co">#&gt; `3SsnPorch`    4.832e+00  3.286e+01   0.147 0.883135    </span></span>
<span><span class="co">#&gt; ScreenPorch    6.115e+01  1.839e+01   3.325 0.000918 ***</span></span>
<span><span class="co">#&gt; PoolArea      -5.348e+01  3.052e+01  -1.753 0.079995 .  </span></span>
<span><span class="co">#&gt; Fence         -3.412e+02  1.031e+03  -0.331 0.740721    </span></span>
<span><span class="co">#&gt; MiscVal       -4.032e-01  1.728e+00  -0.233 0.815621    </span></span>
<span><span class="co">#&gt; MoSold         4.284e+00  3.594e+02   0.012 0.990491    </span></span>
<span><span class="co">#&gt; YrSold        -3.582e+02  7.571e+02  -0.473 0.636255    </span></span>
<span><span class="co">#&gt; SaleType       2.809e+03  1.225e+03   2.293 0.022050 *  </span></span>
<span><span class="co">#&gt; SaleCondition  2.477e+02  1.360e+03   0.182 0.855546    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; (Dispersion parameter for gaussian family taken to be 898969529)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     Null deviance: 6.4808e+12  on 1023  degrees of freedom</span></span>
<span><span class="co">#&gt; Residual deviance: 8.5402e+11  on  950  degrees of freedom</span></span>
<span><span class="co">#&gt; AIC: 24091</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of Fisher Scoring iterations: 2</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">predictions</span> <span class="op">&lt;-</span> <span class="va">lf</span><span class="op">$</span><span class="fu">predict</span><span class="op">(</span>df <span class="op">=</span> <span class="va">xtest</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :</span></span>
<span><span class="co">#&gt; prediction from rank-deficient fit; attr(*, "non-estim") has doubtful cases</span></span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html" class="external-link">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">xtest</span><span class="op">$</span><span class="va">SalePrice</span>, predicted <span class="op">=</span> <span class="va">predictions</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 37143.64</span></span></code></pre></div>
<p><strong>Lasso Regression</strong></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lf</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/LMTrainer.html">LMTrainer</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>family <span class="op">=</span> <span class="st">"gaussian"</span>, alpha <span class="op">=</span> <span class="fl">1</span>, lambda <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span><span class="va">lf</span><span class="op">$</span><span class="fu">fit</span><span class="op">(</span>X <span class="op">=</span> <span class="va">xtrain</span>, y <span class="op">=</span> <span class="st">"SalePrice"</span><span class="op">)</span></span>
<span><span class="va">predictions</span> <span class="op">&lt;-</span> <span class="va">lf</span><span class="op">$</span><span class="fu">predict</span><span class="op">(</span>df <span class="op">=</span> <span class="va">xtest</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html" class="external-link">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">xtest</span><span class="op">$</span><span class="va">SalePrice</span>, predicted <span class="op">=</span> <span class="va">predictions</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 41279.87</span></span></code></pre></div>
<p><strong>Ridge Regression</strong></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lf</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/LMTrainer.html">LMTrainer</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>family <span class="op">=</span> <span class="st">"gaussian"</span>, alpha<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">lf</span><span class="op">$</span><span class="fu">fit</span><span class="op">(</span>X <span class="op">=</span> <span class="va">xtrain</span>, y <span class="op">=</span> <span class="st">"SalePrice"</span><span class="op">)</span></span>
<span><span class="va">predictions</span> <span class="op">&lt;-</span> <span class="va">lf</span><span class="op">$</span><span class="fu">predict</span><span class="op">(</span>df <span class="op">=</span> <span class="va">xtest</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html" class="external-link">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">xtest</span><span class="op">$</span><span class="va">SalePrice</span>, predicted <span class="op">=</span> <span class="va">predictions</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 41190.22</span></span></code></pre></div>
<p><strong>Logistic Regression with CV</strong></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lf</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/LMTrainer.html">LMTrainer</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>family <span class="op">=</span> <span class="st">"gaussian"</span><span class="op">)</span></span>
<span><span class="va">lf</span><span class="op">$</span><span class="fu">cv_model</span><span class="op">(</span>X <span class="op">=</span> <span class="va">xtrain</span>, y <span class="op">=</span> <span class="st">'SalePrice'</span>, nfolds <span class="op">=</span> <span class="fl">5</span>, parallel <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">predictions</span> <span class="op">&lt;-</span> <span class="va">lf</span><span class="op">$</span><span class="fu">cv_predict</span><span class="op">(</span>df <span class="op">=</span> <span class="va">xtest</span><span class="op">)</span></span>
<span><span class="va">coefs</span> <span class="op">&lt;-</span> <span class="va">lf</span><span class="op">$</span><span class="fu">get_importance</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html" class="external-link">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">xtest</span><span class="op">$</span><span class="va">SalePrice</span>, predicted <span class="op">=</span> <span class="va">predictions</span><span class="op">)</span></span></code></pre></div>
<p><strong>Random Forest</strong></p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rf</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/RFTrainer.html">RFTrainer</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>n_estimators <span class="op">=</span> <span class="fl">500</span>,classification <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">rf</span><span class="op">$</span><span class="fu">fit</span><span class="op">(</span>X <span class="op">=</span> <span class="va">xtrain</span>, y <span class="op">=</span> <span class="st">"SalePrice"</span><span class="op">)</span></span>
<span><span class="va">pred</span> <span class="op">&lt;-</span> <span class="va">rf</span><span class="op">$</span><span class="fu">predict</span><span class="op">(</span>df <span class="op">=</span> <span class="va">xtest</span><span class="op">)</span></span>
<span><span class="va">rf</span><span class="op">$</span><span class="fu">get_importance</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;               tmp.order.tmp..decreasing...TRUE..</span></span>
<span><span class="co">#&gt; OverallQual                         825810694164</span></span>
<span><span class="co">#&gt; GarageCars                          506851302952</span></span>
<span><span class="co">#&gt; 1stFlrSF                            457830114005</span></span>
<span><span class="co">#&gt; GarageArea                          446864893634</span></span>
<span><span class="co">#&gt; YearBuilt                           359888233769</span></span>
<span><span class="co">#&gt; BsmtFinSF1                          313129960484</span></span>
<span><span class="co">#&gt; FullBath                            309381523641</span></span>
<span><span class="co">#&gt; GarageYrBlt                         277836399409</span></span>
<span><span class="co">#&gt; KitchenQual                         254334342122</span></span>
<span><span class="co">#&gt; 2ndFlrSF                            199262852145</span></span>
<span><span class="co">#&gt; ExterQual                           187022912130</span></span>
<span><span class="co">#&gt; TotRmsAbvGrd                        187020174533</span></span>
<span><span class="co">#&gt; LotArea                             167191571148</span></span>
<span><span class="co">#&gt; YearRemodAdd                        158447022850</span></span>
<span><span class="co">#&gt; Fireplaces                          145073605993</span></span>
<span><span class="co">#&gt; FireplaceQu                         140904450446</span></span>
<span><span class="co">#&gt; MasVnrArea                          131827479104</span></span>
<span><span class="co">#&gt; BsmtQual                            128488051130</span></span>
<span><span class="co">#&gt; Foundation                           88401438839</span></span>
<span><span class="co">#&gt; LotFrontage                          85507030704</span></span>
<span><span class="co">#&gt; OpenPorchSF                          72560671355</span></span>
<span><span class="co">#&gt; BsmtUnfSF                            64547152086</span></span>
<span><span class="co">#&gt; WoodDeckSF                           63454287049</span></span>
<span><span class="co">#&gt; Neighborhood                         56521964262</span></span>
<span><span class="co">#&gt; BsmtFinType1                         55161868192</span></span>
<span><span class="co">#&gt; HeatingQC                            50387050004</span></span>
<span><span class="co">#&gt; GarageType                           44345042957</span></span>
<span><span class="co">#&gt; BedroomAbvGr                         43657240062</span></span>
<span><span class="co">#&gt; MSSubClass                           41857679430</span></span>
<span><span class="co">#&gt; Exterior2nd                          37858332371</span></span>
<span><span class="co">#&gt; MoSold                               33032231717</span></span>
<span><span class="co">#&gt; OverallCond                          32864653128</span></span>
<span><span class="co">#&gt; RoofStyle                            32699785146</span></span>
<span><span class="co">#&gt; BsmtFullBath                         27181677388</span></span>
<span><span class="co">#&gt; HalfBath                             26774637242</span></span>
<span><span class="co">#&gt; GarageFinish                         26619075389</span></span>
<span><span class="co">#&gt; Exterior1st                          26275214120</span></span>
<span><span class="co">#&gt; HouseStyle                           25464691708</span></span>
<span><span class="co">#&gt; YrSold                               22052509181</span></span>
<span><span class="co">#&gt; LotShape                             21695628409</span></span>
<span><span class="co">#&gt; PoolArea                             21016017007</span></span>
<span><span class="co">#&gt; BsmtExposure                         18038778050</span></span>
<span><span class="co">#&gt; Fence                                17633222237</span></span>
<span><span class="co">#&gt; MSZoning                             16548541084</span></span>
<span><span class="co">#&gt; BsmtHalfBath                         16084388257</span></span>
<span><span class="co">#&gt; GarageCond                           15762942588</span></span>
<span><span class="co">#&gt; LotConfig                            15236384210</span></span>
<span><span class="co">#&gt; MasVnrType                           14015772366</span></span>
<span><span class="co">#&gt; SaleCondition                        13872944355</span></span>
<span><span class="co">#&gt; ScreenPorch                          13584135899</span></span>
<span><span class="co">#&gt; EnclosedPorch                        12740524133</span></span>
<span><span class="co">#&gt; BsmtCond                             11516601722</span></span>
<span><span class="co">#&gt; GarageQual                           11175743163</span></span>
<span><span class="co">#&gt; SaleType                             10837249576</span></span>
<span><span class="co">#&gt; LandContour                          10736811203</span></span>
<span><span class="co">#&gt; BldgType                             10351789143</span></span>
<span><span class="co">#&gt; BsmtFinSF2                           10091169998</span></span>
<span><span class="co">#&gt; RoofMatl                              9571176977</span></span>
<span><span class="co">#&gt; CentralAir                            7871319704</span></span>
<span><span class="co">#&gt; LandSlope                             7312889593</span></span>
<span><span class="co">#&gt; KitchenAbvGr                          7163961154</span></span>
<span><span class="co">#&gt; ExterCond                             7130081684</span></span>
<span><span class="co">#&gt; Condition1                            7012827998</span></span>
<span><span class="co">#&gt; BsmtFinType2                          6659431479</span></span>
<span><span class="co">#&gt; Functional                            6049846564</span></span>
<span><span class="co">#&gt; Heating                               3250451080</span></span>
<span><span class="co">#&gt; PavedDrive                            3060201295</span></span>
<span><span class="co">#&gt; MiscVal                               2679605481</span></span>
<span><span class="co">#&gt; Electrical                            2078967600</span></span>
<span><span class="co">#&gt; 3SsnPorch                             1061849601</span></span>
<span><span class="co">#&gt; Condition2                             954787528</span></span>
<span><span class="co">#&gt; LowQualFinSF                           631801699</span></span>
<span><span class="co">#&gt; Street                                  90020155</span></span>
<span><span class="co">#&gt; Utilities                                      0</span></span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html" class="external-link">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">xtest</span><span class="op">$</span><span class="va">SalePrice</span>, predicted <span class="op">=</span> <span class="va">pred</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 33846.27</span></span></code></pre></div>
<p><strong>Xgboost</strong></p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">xgb</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/XGBTrainer.html">XGBTrainer</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>objective <span class="op">=</span> <span class="st">"reg:linear"</span></span>
<span>                      , n_estimators <span class="op">=</span> <span class="fl">500</span></span>
<span>                      , eval_metric <span class="op">=</span> <span class="st">"rmse"</span></span>
<span>                      , maximize <span class="op">=</span> <span class="cn">F</span></span>
<span>                      , learning_rate <span class="op">=</span> <span class="fl">0.1</span></span>
<span>                      ,max_depth <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span>
<span><span class="va">xgb</span><span class="op">$</span><span class="fu">fit</span><span class="op">(</span>X <span class="op">=</span> <span class="va">xtrain</span>, y <span class="op">=</span> <span class="st">"SalePrice"</span>, valid <span class="op">=</span> <span class="va">xtest</span><span class="op">)</span></span>
<span><span class="va">pred</span> <span class="op">&lt;-</span> <span class="va">xgb</span><span class="op">$</span><span class="fu">predict</span><span class="op">(</span><span class="va">xtest</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html" class="external-link">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">xtest</span><span class="op">$</span><span class="va">SalePrice</span>, predicted <span class="op">=</span> <span class="va">pred</span><span class="op">)</span></span></code></pre></div>
<p><strong>Grid Search</strong></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">xgb</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/XGBTrainer.html">XGBTrainer</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>objective <span class="op">=</span> <span class="st">"reg:linear"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gst</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/GridSearchCV.html">GridSearchCV</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>trainer <span class="op">=</span> <span class="va">xgb</span>,</span>
<span>                             parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>n_estimators <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">50</span><span class="op">)</span>, max_depth <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                             n_folds <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                             scoring <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'accuracy'</span>,<span class="st">'auc'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">gst</span><span class="op">$</span><span class="fu">fit</span><span class="op">(</span><span class="va">xtrain</span>, <span class="st">"SalePrice"</span><span class="op">)</span></span>
<span><span class="va">gst</span><span class="op">$</span><span class="fu">best_iteration</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><strong>Random Search</strong></p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rf</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/RFTrainer.html">RFTrainer</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">rst</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/RandomSearchCV.html">RandomSearchCV</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>trainer <span class="op">=</span> <span class="va">rf</span>,</span>
<span>                             parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>n_estimators <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">10</span><span class="op">)</span>,</span>
<span>                             max_depth <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                             n_folds <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                             scoring <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'accuracy'</span>,<span class="st">'auc'</span><span class="op">)</span>,</span>
<span>                             n_iter <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">rst</span><span class="op">$</span><span class="fu">fit</span><span class="op">(</span><span class="va">xtrain</span>, <span class="st">"SalePrice"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "In total, 3 models will be trained"</span></span></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rst</span><span class="op">$</span><span class="fu">best_iteration</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; $n_estimators</span></span>
<span><span class="co">#&gt; [1] 10</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $max_depth</span></span>
<span><span class="co">#&gt; [1] 2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $accuracy_avg</span></span>
<span><span class="co">#&gt; [1] 0.008806329</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $accuracy_sd</span></span>
<span><span class="co">#&gt; [1] 0.00589522</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $auc_avg</span></span>
<span><span class="co">#&gt; [1] NaN</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $auc_sd</span></span>
<span><span class="co">#&gt; [1] NA</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="binary-classification-data">Binary Classification Data<a class="anchor" aria-label="anchor" href="#binary-classification-data"></a>
</h3>
<p>Here, we will solve a simple binary classification problem (predict
people who survived on titanic ship). The idea here is to demonstrate
how to use this package to solve classification problems.</p>
<p><strong>Data Preparation</strong></p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># load class</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="st">'../data/cla_train.rda'</span><span class="op">)</span></span>
<span><span class="co"># if the above doesn't work, you can try: load("cla_train.rda")</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">cla_train</span><span class="op">)</span></span>
<span><span class="co">#&gt;    PassengerId Survived Pclass</span></span>
<span><span class="co">#&gt;          &lt;int&gt;    &lt;int&gt;  &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1:           1        0      3</span></span>
<span><span class="co">#&gt; 2:           2        1      1</span></span>
<span><span class="co">#&gt; 3:           3        1      3</span></span>
<span><span class="co">#&gt; 4:           4        1      1</span></span>
<span><span class="co">#&gt; 5:           5        0      3</span></span>
<span><span class="co">#&gt; 6:           6        0      3</span></span>
<span><span class="co">#&gt;                                                   Name    Sex   Age SibSp Parch</span></span>
<span><span class="co">#&gt;                                                 &lt;char&gt; &lt;char&gt; &lt;num&gt; &lt;int&gt; &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1:                             Braund, Mr. Owen Harris   male    22     1     0</span></span>
<span><span class="co">#&gt; 2: Cumings, Mrs. John Bradley (Florence Briggs Thayer) female    38     1     0</span></span>
<span><span class="co">#&gt; 3:                              Heikkinen, Miss. Laina female    26     0     0</span></span>
<span><span class="co">#&gt; 4:        Futrelle, Mrs. Jacques Heath (Lily May Peel) female    35     1     0</span></span>
<span><span class="co">#&gt; 5:                            Allen, Mr. William Henry   male    35     0     0</span></span>
<span><span class="co">#&gt; 6:                                    Moran, Mr. James   male    NA     0     0</span></span>
<span><span class="co">#&gt;              Ticket    Fare  Cabin Embarked</span></span>
<span><span class="co">#&gt;              &lt;char&gt;   &lt;num&gt; &lt;char&gt;   &lt;char&gt;</span></span>
<span><span class="co">#&gt; 1:        A/5 21171  7.2500               S</span></span>
<span><span class="co">#&gt; 2:         PC 17599 71.2833    C85        C</span></span>
<span><span class="co">#&gt; 3: STON/O2. 3101282  7.9250               S</span></span>
<span><span class="co">#&gt; 4:           113803 53.1000   C123        S</span></span>
<span><span class="co">#&gt; 5:           373450  8.0500               S</span></span>
<span><span class="co">#&gt; 6:           330877  8.4583               Q</span></span></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># split the data</span></span>
<span><span class="va">split</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/caret/man/createDataPartition.html" class="external-link">createDataPartition</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">cla_train</span><span class="op">$</span><span class="va">Survived</span>,p <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span></span>
<span><span class="va">xtrain</span> <span class="op">&lt;-</span> <span class="va">cla_train</span><span class="op">[</span><span class="va">split</span><span class="op">$</span><span class="va">Resample1</span><span class="op">]</span></span>
<span><span class="va">xtest</span> <span class="op">&lt;-</span> <span class="va">cla_train</span><span class="op">[</span><span class="op">!</span><span class="va">split</span><span class="op">$</span><span class="va">Resample1</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># encode categorical variables - shorter way</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">c</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Embarked'</span>,<span class="st">'Sex'</span>,<span class="st">'Cabin'</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">lbl</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/LabelEncoder.html">LabelEncoder</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="va">lbl</span><span class="op">$</span><span class="fu">fit</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">xtrain</span><span class="op">[[</span><span class="va">c</span><span class="op">]</span><span class="op">]</span>, <span class="va">xtest</span><span class="op">[[</span><span class="va">c</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">xtrain</span><span class="op">[[</span><span class="va">c</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">lbl</span><span class="op">$</span><span class="fu">transform</span><span class="op">(</span><span class="va">xtrain</span><span class="op">[[</span><span class="va">c</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">xtest</span><span class="op">[[</span><span class="va">c</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">lbl</span><span class="op">$</span><span class="fu">transform</span><span class="op">(</span><span class="va">xtest</span><span class="op">[[</span><span class="va">c</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; The data contains blank values. Imputing them with 'NA' </span></span>
<span><span class="co">#&gt; The data contains blank values. Imputing them with 'NA' </span></span>
<span><span class="co">#&gt; The data contains blank values. Imputing them with 'NA' </span></span>
<span><span class="co">#&gt; The data contains blank values. Imputing them with 'NA' </span></span>
<span><span class="co">#&gt; The data contains blank values. Imputing them with 'NA'</span></span></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># impute missing values</span></span>
<span><span class="va">xtrain</span><span class="op">[</span>, <span class="va">Age</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/replace.html" class="external-link">replace</a></span><span class="op">(</span><span class="va">Age</span>, <span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">Age</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">Age</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">xtest</span><span class="op">[</span>, <span class="va">Age</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/replace.html" class="external-link">replace</a></span><span class="op">(</span><span class="va">Age</span>, <span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">Age</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">Age</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># drop these features</span></span>
<span><span class="va">to_drop</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'PassengerId'</span>,<span class="st">'Ticket'</span>,<span class="st">'Name'</span><span class="op">)</span></span>
<span></span>
<span><span class="va">xtrain</span> <span class="op">&lt;-</span> <span class="va">xtrain</span><span class="op">[</span>,<span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">to_drop</span><span class="op">)</span>, with<span class="op">=</span><span class="cn">F</span><span class="op">]</span></span>
<span><span class="va">xtest</span> <span class="op">&lt;-</span> <span class="va">xtest</span><span class="op">[</span>,<span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">to_drop</span><span class="op">)</span>, with<span class="op">=</span><span class="cn">F</span><span class="op">]</span></span></code></pre></div>
<p>Now, our data is ready to be served for model training. Let’s do
it.</p>
<p><strong>KNN Classification</strong></p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">knn</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/KNNTrainer.html">KNNTrainer</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>k <span class="op">=</span> <span class="fl">2</span>,prob <span class="op">=</span> <span class="cn">T</span>,type <span class="op">=</span> <span class="st">'class'</span><span class="op">)</span></span>
<span><span class="va">knn</span><span class="op">$</span><span class="fu">fit</span><span class="op">(</span>train <span class="op">=</span> <span class="va">xtrain</span>, test <span class="op">=</span> <span class="va">xtest</span>, y <span class="op">=</span> <span class="st">'Survived'</span><span class="op">)</span></span>
<span><span class="va">probs</span> <span class="op">&lt;-</span> <span class="va">knn</span><span class="op">$</span><span class="fu">predict</span><span class="op">(</span>type <span class="op">=</span> <span class="st">'prob'</span><span class="op">)</span></span>
<span><span class="va">labels</span> <span class="op">&lt;-</span> <span class="va">knn</span><span class="op">$</span><span class="fu">predict</span><span class="op">(</span>type <span class="op">=</span> <span class="st">'raw'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/auc.html" class="external-link">auc</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">xtest</span><span class="op">$</span><span class="va">Survived</span>, predicted <span class="op">=</span> <span class="va">labels</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.6385027</span></span></code></pre></div>
<p><strong>Naive Bayes Classification</strong></p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nb</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/NBTrainer.html">NBTrainer</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">nb</span><span class="op">$</span><span class="fu">fit</span><span class="op">(</span><span class="va">xtrain</span>, <span class="st">'Survived'</span><span class="op">)</span></span>
<span><span class="va">pred</span> <span class="op">&lt;-</span> <span class="va">nb</span><span class="op">$</span><span class="fu">predict</span><span class="op">(</span><span class="va">xtest</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: predict.naive_bayes(): more features in the newdata are provided as</span></span>
<span><span class="co">#&gt; there are probability tables in the object. Calculation is performed based on</span></span>
<span><span class="co">#&gt; features to be found in the tables.</span></span></code></pre></div>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/auc.html" class="external-link">auc</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">xtest</span><span class="op">$</span><span class="va">Survived</span>, predicted <span class="op">=</span> <span class="va">pred</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.7771836</span></span></code></pre></div>
<p><strong>SVM Classification</strong></p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#predicts labels</span></span>
<span><span class="va">svm</span> <span class="op">&lt;-</span> <span class="va">SVMTrainer</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">svm</span><span class="op">$</span><span class="fu">fit</span><span class="op">(</span><span class="va">xtrain</span>, <span class="st">'Survived'</span><span class="op">)</span></span>
<span><span class="va">pred</span> <span class="op">&lt;-</span> <span class="va">svm</span><span class="op">$</span><span class="fu">predict</span><span class="op">(</span><span class="va">xtest</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/auc.html" class="external-link">auc</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">xtest</span><span class="op">$</span><span class="va">Survived</span>, predicted<span class="op">=</span><span class="va">pred</span><span class="op">)</span></span></code></pre></div>
<p><strong>Logistic Regression</strong></p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lf</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/LMTrainer.html">LMTrainer</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>family <span class="op">=</span> <span class="st">"binomial"</span><span class="op">)</span></span>
<span><span class="va">lf</span><span class="op">$</span><span class="fu">fit</span><span class="op">(</span>X <span class="op">=</span> <span class="va">xtrain</span>, y <span class="op">=</span> <span class="st">"Survived"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">lf</span><span class="op">$</span><span class="va">model</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; stats::glm(formula = f, family = self$family, data = X, weights = self$weights)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;              Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span><span class="co">#&gt; (Intercept)  1.830070   0.616894   2.967  0.00301 ** </span></span>
<span><span class="co">#&gt; Pclass      -0.980785   0.192493  -5.095 3.48e-07 ***</span></span>
<span><span class="co">#&gt; Sex          2.508241   0.230374  10.888  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; Age         -0.041034   0.009309  -4.408 1.04e-05 ***</span></span>
<span><span class="co">#&gt; SibSp       -0.235520   0.117715  -2.001  0.04542 *  </span></span>
<span><span class="co">#&gt; Parch       -0.098742   0.137791  -0.717  0.47361    </span></span>
<span><span class="co">#&gt; Fare         0.001281   0.002842   0.451  0.65230    </span></span>
<span><span class="co">#&gt; Cabin        0.008408   0.004786   1.757  0.07899 .  </span></span>
<span><span class="co">#&gt; Embarked     0.248088   0.166616   1.489  0.13649    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; (Dispersion parameter for binomial family taken to be 1)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     Null deviance: 831.52  on 623  degrees of freedom</span></span>
<span><span class="co">#&gt; Residual deviance: 564.76  on 615  degrees of freedom</span></span>
<span><span class="co">#&gt; AIC: 582.76</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of Fisher Scoring iterations: 5</span></span></code></pre></div>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">predictions</span> <span class="op">&lt;-</span> <span class="va">lf</span><span class="op">$</span><span class="fu">predict</span><span class="op">(</span>df <span class="op">=</span> <span class="va">xtest</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/auc.html" class="external-link">auc</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">xtest</span><span class="op">$</span><span class="va">Survived</span>, predicted <span class="op">=</span> <span class="va">predictions</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.8832145</span></span></code></pre></div>
<p><strong>Lasso Logistic Regression</strong></p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lf</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/LMTrainer.html">LMTrainer</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>family<span class="op">=</span><span class="st">"binomial"</span>, alpha<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">lf</span><span class="op">$</span><span class="fu">cv_model</span><span class="op">(</span>X <span class="op">=</span> <span class="va">xtrain</span>, y <span class="op">=</span> <span class="st">"Survived"</span>, nfolds <span class="op">=</span> <span class="fl">5</span>, parallel <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">pred</span> <span class="op">&lt;-</span> <span class="va">lf</span><span class="op">$</span><span class="fu">cv_predict</span><span class="op">(</span>df <span class="op">=</span> <span class="va">xtest</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/auc.html" class="external-link">auc</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">xtest</span><span class="op">$</span><span class="va">Survived</span>, predicted <span class="op">=</span> <span class="va">pred</span><span class="op">)</span></span></code></pre></div>
<p><strong>Ridge Logistic Regression</strong></p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lf</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/LMTrainer.html">LMTrainer</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>family<span class="op">=</span><span class="st">"binomial"</span>, alpha<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">lf</span><span class="op">$</span><span class="fu">cv_model</span><span class="op">(</span>X <span class="op">=</span> <span class="va">xtrain</span>, y <span class="op">=</span> <span class="st">"Survived"</span>, nfolds <span class="op">=</span> <span class="fl">5</span>, parallel <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">pred</span> <span class="op">&lt;-</span> <span class="va">lf</span><span class="op">$</span><span class="fu">cv_predict</span><span class="op">(</span>df <span class="op">=</span> <span class="va">xtest</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/auc.html" class="external-link">auc</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">xtest</span><span class="op">$</span><span class="va">Survived</span>, predicted <span class="op">=</span> <span class="va">pred</span><span class="op">)</span></span></code></pre></div>
<p><strong>Random Forest</strong></p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rf</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/RFTrainer.html">RFTrainer</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>n_estimators <span class="op">=</span> <span class="fl">500</span>,classification <span class="op">=</span> <span class="fl">1</span>, max_features <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">rf</span><span class="op">$</span><span class="fu">fit</span><span class="op">(</span>X <span class="op">=</span> <span class="va">xtrain</span>, y <span class="op">=</span> <span class="st">"Survived"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pred</span> <span class="op">&lt;-</span> <span class="va">rf</span><span class="op">$</span><span class="fu">predict</span><span class="op">(</span>df <span class="op">=</span> <span class="va">xtest</span><span class="op">)</span></span>
<span><span class="va">rf</span><span class="op">$</span><span class="fu">get_importance</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;          tmp.order.tmp..decreasing...TRUE..</span></span>
<span><span class="co">#&gt; Sex                                69.10742</span></span>
<span><span class="co">#&gt; Fare                               57.96084</span></span>
<span><span class="co">#&gt; Age                                48.50156</span></span>
<span><span class="co">#&gt; Pclass                             23.91175</span></span>
<span><span class="co">#&gt; Cabin                              21.19329</span></span>
<span><span class="co">#&gt; SibSp                              12.58503</span></span>
<span><span class="co">#&gt; Parch                              10.55128</span></span>
<span><span class="co">#&gt; Embarked                           10.07059</span></span></code></pre></div>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/auc.html" class="external-link">auc</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">xtest</span><span class="op">$</span><span class="va">Survived</span>, predicted <span class="op">=</span> <span class="va">pred</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.7988414</span></span></code></pre></div>
<p><strong>Xgboost</strong></p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">xgb</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/XGBTrainer.html">XGBTrainer</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>objective <span class="op">=</span> <span class="st">"binary:logistic"</span></span>
<span>                      , n_estimators <span class="op">=</span> <span class="fl">500</span></span>
<span>                      , eval_metric <span class="op">=</span> <span class="st">"auc"</span></span>
<span>                      , maximize <span class="op">=</span> <span class="cn">T</span></span>
<span>                      , learning_rate <span class="op">=</span> <span class="fl">0.1</span></span>
<span>                      ,max_depth <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span>
<span><span class="va">xgb</span><span class="op">$</span><span class="fu">fit</span><span class="op">(</span>X <span class="op">=</span> <span class="va">xtrain</span>, y <span class="op">=</span> <span class="st">"Survived"</span>, valid <span class="op">=</span> <span class="va">xtest</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pred</span> <span class="op">&lt;-</span> <span class="va">xgb</span><span class="op">$</span><span class="fu">predict</span><span class="op">(</span><span class="va">xtest</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/auc.html" class="external-link">auc</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">xtest</span><span class="op">$</span><span class="va">Survived</span>, predicted <span class="op">=</span> <span class="va">pred</span><span class="op">)</span></span></code></pre></div>
<p><strong>Grid Search</strong></p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">xgb</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/XGBTrainer.html">XGBTrainer</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>objective<span class="op">=</span><span class="st">"binary:logistic"</span><span class="op">)</span></span>
<span><span class="va">gst</span> <span class="op">&lt;-</span><span class="va"><a href="../reference/GridSearchCV.html">GridSearchCV</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>trainer <span class="op">=</span> <span class="va">xgb</span>,</span>
<span>                             parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>n_estimators <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">50</span><span class="op">)</span>,</span>
<span>                             max_depth <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                             n_folds <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                             scoring <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'accuracy'</span>,<span class="st">'auc'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">gst</span><span class="op">$</span><span class="fu">fit</span><span class="op">(</span><span class="va">xtrain</span>, <span class="st">"Survived"</span><span class="op">)</span></span>
<span><span class="va">gst</span><span class="op">$</span><span class="fu">best_iteration</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><strong>Random Search</strong></p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rf</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/RFTrainer.html">RFTrainer</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">rst</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/RandomSearchCV.html">RandomSearchCV</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>trainer <span class="op">=</span> <span class="va">rf</span>,</span>
<span>                             parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>n_estimators <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">50</span><span class="op">)</span>, max_depth <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                             n_folds <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                             scoring <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'accuracy'</span>,<span class="st">'auc'</span><span class="op">)</span>,</span>
<span>                             n_iter <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">rst</span><span class="op">$</span><span class="fu">fit</span><span class="op">(</span><span class="va">xtrain</span>, <span class="st">"Survived"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "In total, 3 models will be trained"</span></span></code></pre></div>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rst</span><span class="op">$</span><span class="fu">best_iteration</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; $n_estimators</span></span>
<span><span class="co">#&gt; [1] 50</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $max_depth</span></span>
<span><span class="co">#&gt; [1] 5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $accuracy_avg</span></span>
<span><span class="co">#&gt; [1] 0.8028846</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $accuracy_sd</span></span>
<span><span class="co">#&gt; [1] 0.01733438</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $auc_avg</span></span>
<span><span class="co">#&gt; [1] 0.7804264</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $auc_sd</span></span>
<span><span class="co">#&gt; [1] 0.02631447</span></span></code></pre></div>
<p>Let’s create some new feature based on target variable using target
encoding and test a model.</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># add target encoding features</span></span>
<span><span class="va">xtrain</span><span class="op">[</span>, <span class="va">feat_01</span> <span class="op">:=</span> <span class="fu"><a href="../reference/smoothMean.html">smoothMean</a></span><span class="op">(</span>train_df <span class="op">=</span> <span class="va">xtrain</span>,</span>
<span>                        test_df <span class="op">=</span> <span class="va">xtest</span>,</span>
<span>                        colname <span class="op">=</span> <span class="st">"Embarked"</span>,</span>
<span>                        target <span class="op">=</span> <span class="st">"Survived"</span><span class="op">)</span><span class="op">$</span><span class="va">train</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">xtest</span><span class="op">[</span>, <span class="va">feat_01</span> <span class="op">:=</span> <span class="fu"><a href="../reference/smoothMean.html">smoothMean</a></span><span class="op">(</span>train_df <span class="op">=</span> <span class="va">xtrain</span>,</span>
<span>                               test_df <span class="op">=</span> <span class="va">xtest</span>,</span>
<span>                               colname <span class="op">=</span> <span class="st">"Embarked"</span>,</span>
<span>                               target <span class="op">=</span> <span class="st">"Survived"</span><span class="op">)</span><span class="op">$</span><span class="va">test</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># train a random forest</span></span>
<span><span class="co"># Random Forest</span></span>
<span><span class="va">rf</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/RFTrainer.html">RFTrainer</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>n_estimators <span class="op">=</span> <span class="fl">500</span>,classification <span class="op">=</span> <span class="fl">1</span>, max_features <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">rf</span><span class="op">$</span><span class="fu">fit</span><span class="op">(</span>X <span class="op">=</span> <span class="va">xtrain</span>, y <span class="op">=</span> <span class="st">"Survived"</span><span class="op">)</span></span>
<span><span class="va">pred</span> <span class="op">&lt;-</span> <span class="va">rf</span><span class="op">$</span><span class="fu">predict</span><span class="op">(</span>df <span class="op">=</span> <span class="va">xtest</span><span class="op">)</span></span>
<span><span class="va">rf</span><span class="op">$</span><span class="fu">get_importance</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;          tmp.order.tmp..decreasing...TRUE..</span></span>
<span><span class="co">#&gt; Sex                               71.417138</span></span>
<span><span class="co">#&gt; Fare                              61.039958</span></span>
<span><span class="co">#&gt; Age                               51.787990</span></span>
<span><span class="co">#&gt; Pclass                            24.257112</span></span>
<span><span class="co">#&gt; Cabin                             21.549374</span></span>
<span><span class="co">#&gt; SibSp                             12.374317</span></span>
<span><span class="co">#&gt; Parch                             10.392826</span></span>
<span><span class="co">#&gt; feat_01                            6.490151</span></span>
<span><span class="co">#&gt; Embarked                           6.270997</span></span></code></pre></div>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/auc.html" class="external-link">auc</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">xtest</span><span class="op">$</span><span class="va">Survived</span>, predicted <span class="op">=</span> <span class="va">pred</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.7988414</span></span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Manish Saraswat.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
